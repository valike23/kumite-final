(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{3:function(e,t,n){"use strict";n.d(t,"a",(function(){return fr}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,u=Object.keys,s=Array.isArray;function c(e,t){return"object"!=typeof t||u(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||a.Promise||(a.Promise=Promise);var l=Object.getPrototypeOf,f={}.hasOwnProperty;function h(e,t){return f.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?u:Reflect.ownKeys)(t).forEach((function(n){y(e,n,t[n])}))}var p=Object.defineProperty;function y(e,t,n,r){p(e,t,c(n&&h(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function v(e){return{from:function(t){return e.prototype=Object.create(t.prototype),y(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor;function b(e,t){var n;return m(e,t)||(n=l(e))&&b(n,t)}var g=[].slice;function w(e,t,n){return g.call(e,t,n)}function _(e,t){return t(e)}function x(e){if(!e)throw new Error("Assertion Failed")}function k(e){a.setImmediate?setImmediate(e):setTimeout(e,0)}function O(e,t){if(h(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=O(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return void 0===u?void 0:O(u,t.substr(a+1))}}function P(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){x("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)P(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===n?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var c=e[a];c&&h(e,a)||(c=e[a]={}),P(c,u,n)}}else void 0===n?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function E(e){var t={};for(var n in e)h(e,n)&&(t[n]=e[n]);return t}var K=[].concat;function S(e){return K.apply([],e)}var A="Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(S([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return a[e]})),j=new Set(A.map((function(e){return a[e]})));var C=null;function q(e){C=new WeakMap;var t=function e(t){if(!t||"object"!=typeof t)return t;var n=C.get(t);if(n)return n;if(s(t)){n=[],C.set(t,n);for(var r=0,i=t.length;r<i;++r)n.push(e(t[r]))}else if(j.has(t.constructor))n=t;else{var o=l(t);for(var a in n=o===Object.prototype?{}:Object.create(o),C.set(t,n),t)h(t,a)&&(n[a]=e(t[a]))}return n}(e);return C=null,t}var D={}.toString;function I(e){return D.call(e).slice(8,-1)}var B="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",T="symbol"==typeof B?function(e){var t;return null!=e&&(t=e[B])&&t.apply(e)}:function(){return null};function R(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var F={};function M(e){var t,n,r,i;if(1===arguments.length){if(s(e))return e.slice();if(this===F&&"string"==typeof e)return[e];if(i=T(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},L="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function U(e,t){L=e,V=t}var V=function(){return!0},z=!new Error("").stack;function W(){if(z)try{throw W.arguments,new Error}catch(e){return e}return new Error}function Y(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(V).map((function(e){return"\n"+e})).join("")):""}var G=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],H=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(G),Q={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function X(e,t){this._e=W(),this.name=e,this.message=t}function J(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function $(e,t,n,r){this._e=W(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=J(e,t)}function Z(e,t){this._e=W(),this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=J(e,this.failures)}v(X).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Y(this._e,2))}},toString:function(){return this.name+": "+this.message}}),v($).from(X),v(Z).from(X);var ee=H.reduce((function(e,t){return e[t]=t+"Error",e}),{}),te=X,ne=H.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=W(),this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=Q[t]||n,this.inner=null)}return v(r).from(te),e[t]=r,e}),{});ne.Syntax=SyntaxError,ne.Type=TypeError,ne.Range=RangeError;var re=G.reduce((function(e,t){return e[t+"Error"]=ne[t],e}),{});var ie=H.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=ne[t]),e}),{});function oe(){}function ae(e){return e}function ue(e,t){return null==e||e===ae?t:function(n){return t(e(n))}}function se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ce(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?se(i,this.onerror):i),void 0!==o?o:n}}function le(e,t){return e===oe?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?se(r,this.onerror):r)}}function fe(e,t){return e===oe?t:function(n){var r=e.apply(this,arguments);c(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?se(i,this.onsuccess):i),o&&(this.onerror=this.onerror?se(o,this.onerror):o),void 0===r?void 0===a?void 0:a:c(r,a)}}function he(e,t){return e===oe?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function de(e,t){return e===oe?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ie.ModifyError=$,ie.DexieError=X,ie.BulkError=Z;var pe={},ye="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),ve=ye[0],me=ye[1],be=ye[2],ge=me&&me.then,we=ve&&ve.constructor,_e=!!be,xe=!1;var ke=function(e,t){qe.push([e,t]),Pe&&(queueMicrotask(ze),Pe=!1)},Oe=!0,Pe=!0,Ee=[],Ke=[],Se=null,Ae=ae,je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:oe,pgp:!1,env:{},finalize:oe},Ce=je,qe=[],De=0,Ie=[];function Be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=Ce;if(L&&(this._stackHolder=W(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==pe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Me(this,this._value))}this._state=null,this._value=null,++t.ref,Fe(this,e)}var Te={get:function(){var e=Ce,t=et;function n(n,r){var i=this,o=!e.global&&(e!==Ce||t!==et),a=o&&!it(),u=new Be((function(t,u){Le(i,new Re(ft(n,e,o,a),ft(r,e,o,a),t,u,e))}));return L&&Ve(u,this),u}return n.prototype=pe,n},set:function(e){y(this,"then",e&&e.prototype===pe?Te:{get:function(){return e},set:Te.set})}};function Re(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Fe(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&We();t&&"function"==typeof t.then?Fe(e,(function(e,n){t instanceof Be?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ne(e)),n&&Ye()}}),Me.bind(null,e))}catch(t){Me(e,t)}}function Me(e,t){if(Ke.push(t),null===e._state){var n=e._lib&&We();t=Ae(t),e._state=!1,e._value=t,L&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=b(t,"stack");t._promise=e,y(t,"stack",{get:function(){return xe?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Ee.some((function(t){return t._value===e._value}))||Ee.push(e)}(e),Ne(e),n&&Ye()}}function Ne(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Le(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===De&&(++De,ke((function(){0==--De&&Ge()}),[]))}function Le(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++De,ke(Ue,[n,e,t])}else e._listeners.push(t)}function Ue(e,t,n){try{Se=t;var r,i=t._value;t._state?r=e(i):(Ke.length&&(Ke=[]),r=e(i),-1===Ke.indexOf(i)&&function(e){var t=Ee.length;for(;t;)if(Ee[--t]._value===e._value)return void Ee.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Se=null,0==--De&&Ge(),--n.psd.ref||n.psd.finalize()}}function Ve(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function ze(){lt(je,(function(){We()&&Ye()}))}function We(){var e=Oe;return Oe=!1,Pe=!1,e}function Ye(){var e,t,n;do{for(;qe.length>0;)for(e=qe,qe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(qe.length>0);Oe=!0,Pe=!0}function Ge(){var e=Ee;Ee=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Ie.slice(0),n=t.length;n;)t[--n]()}function He(e){return new Be(pe,!1,e)}function Qe(e,t){var n=Ce;return function(){var r=We(),i=Ce;try{return st(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{st(i,!1),r&&Ye()}}}d(Be.prototype,{then:Te,_then:function(e,t){Le(this,new Re(null,null,e,t,Ce))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):He(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):He(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),He(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{xe=!0;var e=function e(t,n,r){if(n.length===r)return n;var i="";if(!1===t._state){var o,a,u=t._value;null!=u?(o=u.name||"Error",a=u.message||u,i=Y(u,0)):(o=u,a=""),n.push(o+(a?": "+a:"")+i)}L&&((i=Y(t._stackHolder,2))&&-1===n.indexOf(i)&&n.push(i),t._prev&&e(t._prev,n,r));return n}(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{xe=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Be((function(r,i){var o=setTimeout((function(){return i(new ne.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&y(Be.prototype,Symbol.toStringTag,"Dexie.Promise"),je.env=ct(),d(Be,{all:function(){var e=M.apply(null,arguments).map(ot);return new Be((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Be.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Be)return e;if(e&&"function"==typeof e.then)return new Be((function(t,n){e.then(t,n)}));var t=new Be(pe,!0,e);return Ve(t,Se),t},reject:He,race:function(){var e=M.apply(null,arguments).map(ot);return new Be((function(t,n){e.map((function(e){return Be.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Ce},set:function(e){return Ce=e}},totalEchoes:{get:function(){return et}},newPSD:nt,usePSD:lt,scheduler:{get:function(){return ke},set:function(e){ke=e}},rejectionMapper:{get:function(){return Ae},set:function(e){Ae=e}},follow:function(e,t){return new Be((function(n,r){return nt((function(t,n){var r=Ce;r.unhandleds=[],r.onunhandled=n,r.finalize=se((function(){var e=this;!function(e){Ie.push((function t(){e(),Ie.splice(Ie.indexOf(t),1)})),++De,ke((function(){0==--De&&Ge()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),we&&(we.allSettled&&y(Be,"allSettled",(function(){var e=M.apply(null,arguments).map(ot);return new Be((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Be.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),we.any&&"undefined"!=typeof AggregateError&&y(Be,"any",(function(){var e=M.apply(null,arguments).map(ot);return new Be((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Be.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var Xe={awaits:0,echoes:0,id:0},Je=0,$e=[],Ze=0,et=0,tt=0;function nt(e,t,n,r){var i=Ce,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++tt;var a=je.env;o.env=_e?{Promise:Be,PromiseProp:{value:Be,configurable:!0,writable:!0},all:Be.all,race:Be.race,allSettled:Be.allSettled,any:Be.any,resolve:Be.resolve,reject:Be.reject,nthen:ht(a.nthen,o),gthen:ht(a.gthen,o)}:{},t&&c(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=lt(o,e,n,r);return 0===o.ref&&o.finalize(),u}function rt(){return Xe.id||(Xe.id=++Je),++Xe.awaits,Xe.echoes+=100,Xe.id}function it(){return!!Xe.awaits&&(0==--Xe.awaits&&(Xe.id=0),Xe.echoes=100*Xe.awaits,!0)}function ot(e){return Xe.echoes&&e&&e.constructor===we?(rt(),e.then((function(e){return it(),e}),(function(e){return it(),dt(e)}))):e}function at(e){++et,Xe.echoes&&0!=--Xe.echoes||(Xe.echoes=Xe.id=0),$e.push(Ce),st(e,!0)}function ut(){var e=$e[$e.length-1];$e.pop(),st(e,!1)}function st(e,t){var n=Ce;if((t?!Xe.echoes||Ze++&&e===Ce:!Ze||--Ze&&e===Ce)||queueMicrotask(t?at.bind(null,e):ut),e!==Ce&&(Ce=e,n===je&&(je.env=ct()),_e)){var r=je.env.Promise,i=e.env;me.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(a,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function ct(){var e=a.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:me.then,gthen:e.prototype.then}:{}}function lt(e,t,n,r,i){var o=Ce;try{return st(e,!0),t(n,r,i)}finally{st(o,!1)}}function ft(e,t,n,r){return"function"!=typeof e?e:function(){var i=Ce;n&&rt(),st(t,!0);try{return e.apply(this,arguments)}finally{st(i,!1),r&&queueMicrotask(it)}}}function ht(e,t){return function(n,r){return e.call(this,ft(n,t),ft(r,t))}}-1===(""+ge).indexOf("[native code]")&&(rt=it=oe);var dt=Be.reject;var pt=String.fromCharCode(65535),yt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",vt=[],mt="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),bt=mt,gt=mt,wt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function _t(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var xt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function kt(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=q(t))[e],t}}function Ot(){throw ne.Type()}function Pt(e,t){try{var n=Et(e),r=Et(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(Kt(e),Kt(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var a=Pt(e[o],t[o]);if(0!==a)return a}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function Et(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=I(e);return"ArrayBuffer"===n?"binary":n}function Kt(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var St=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Ce.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new ne.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=We();try{return r&&r.db===this.db?r===Ce.trans?r._promise(e,o,n):nt((function(){return r._promise(e,o,n)}),{trans:r,transless:Ce.transless||Ce}):function e(t,n,r,i){if(t.idbdb&&(t._state.openComplete||Ce.letThrough||t._vip)){var o=t._createTransaction(n,r,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(o){return o.name===ee.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then((function(){return e(t,n,r,i)}))):dt(o)}return o._promise(n,(function(e,t){return nt((function(){return Ce.trans=o,i(e,t,o)}))})).then((function(e){if("readwrite"===n)try{o.idbtrans.commit()}catch(e){}return"readonly"===n?e:o._completion.then((function(){return e}))}))}if(t._state.openComplete)return dt(new ne.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return dt(new ne.DatabaseClosed);t.open().catch(oe)}return t._state.dbReadyPromise.then((function(){return e(t,n,r,i)}))}(this.db,e,[this.name],o)}finally{a&&Ye()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=u(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==pt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map((function(t){return e[t]})))}!n&&L&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit of a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function a(e,t){return 0===o.cmp(e,t)}var c=t.reduce((function(t,n){var r=t[0],o=t[1],u=i[n],c=e[n];return[r||u,r||!u?_t(o,u&&u.multi?function(e){var t=O(e,n);return s(t)&&t.some((function(e){return a(c,e)}))}:function(e){return a(c,O(e,n))}):o]}),[null,null]),l=c[0],f=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var t=this.db,n=this.name;this.schema.mappedClass=e,e.prototype instanceof Ot&&(e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(i,e),Object.defineProperty(i.prototype,"db",{get:function(){return t},enumerable:!1,configurable:!0}),i.prototype.table=function(){return n},i}(e));for(var i=new Set,o=e.prototype;o;o=l(o))Object.getOwnPropertyNames(o).forEach((function(e){return i.add(e)}));var a=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!i.has(r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=a,this.hook("reading",a),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=kt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{P(e,o,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof e||s(e))return this.where(":id").equals(e).modify(t);var n=O(e,this.schema.primKey.keyPath);return void 0===n?dt(new ne.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=kt(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{P(e,o,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:xt})})).then((function(e){return e.numFailures?Be.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&i)throw new ne.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(kt(u)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new Z("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&i)throw new ne.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ne.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(kt(u)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new Z("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map((function(e){return e.key})),i=e.map((function(e){return e.changes})),o=[];return this._trans("readwrite",(function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then((function(u){var s=[],c=[];e.forEach((function(e,n){var r=e.key,i=e.changes,a=u[n];if(a){for(var l=0,f=Object.keys(i);l<f.length;l++){var h=f[l],d=i[h];if(h===t.schema.primKey.keyPath){if(0!==Pt(d,r))throw new ne.Constraint("Cannot update primary key in bulkUpdate()")}else P(a,h,d)}o.push(n),s.push(r),c.push(a)}}));var l=s.length;return n.mutate({trans:a,type:"put",keys:s,values:c,updates:{keys:r,changeSpecs:i}}).then((function(e){var n=e.numFailures,r=e.failures;if(0===n)return l;for(var i=0,a=Object.keys(r);i<a.length;i++){var u=a[i],s=o[Number(u)];if(null!=s){var c=r[u];delete r[u],r[s]=c}}throw new Z("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(l," operations failed"),r)}))}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new Z("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),o)}))},e}();function At(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(e,r,i){if("object"==typeof e)return a(e);r||(r=he),i||(i=oe);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function a(e){u(e).forEach((function(t){var n=e[t];if(s(n))o(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new ne.InvalidArgument("Invalid event config");var r=o(t,ae,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){k((function(){e.apply(null,t)}))}))}))}}))}}function jt(e,t){return v(t).from({prototype:e}),t}function Ct(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function qt(e,t){e.filter=_t(e.filter,t)}function Dt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return _t(r(),t())}:t,e.justLimit=n&&!r}function It(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new ne.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Bt(e,t,n){var r=It(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Tt(e,t,n,r){var i=e.replayFilter?_t(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),h(o,u)||(o[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Rt(Bt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Rt(Bt(e,r,n),_t(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Rt(e,t,n,r){var i=Qe(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=oe}),(function(t){e.fail(t),n=oe}))||i(e.value,e,(function(e){return n=e})),n()}))}))}var Ft=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,dt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,dt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=_t(t.algorithm,e)},e.prototype._iterate=function(e,t){return Tt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Tt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Ct(n,!0))return r.count({trans:e,query:{index:It(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return Tt(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Ct(n,!0)&&n.limit>0){var r=n.valueMapper,i=It(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return Tt(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ct(t)?Dt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Dt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Dt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return qt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return qt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=_t(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Ct(t,!0)&&t.limit>0)return this._read((function(e){var n=It(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return qt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=h(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var o=u(e),a=o.length;i=function(t){for(var n=!1,r=0;r<a;++r){var i=o[r],u=e[i];O(t,i)!==u&&(P(t,i,u),n=!0)}return n}}var s=n.table.core,c=s.schema.primaryKey,l=c.outbound,f=c.extractKey,h=t.db._options.modifyChunkSize||200,d=[],p=0,y=[],v=function(e,t){var n=t.failures,r=t.numFailures;p+=e-r;for(var i=0,o=u(n);i<o.length;i++){var a=o[i];d.push(n[a])}};return t.clone().primaryKeys().then((function(t){var o=function(a){var u=Math.min(h,t.length-a);return s.getMany({trans:r,keys:t.slice(a,a+u),cache:"immutable"}).then((function(c){for(var d=[],p=[],y=l?[]:null,m=[],b=0;b<u;++b){var g=c[b],w={value:q(g),primKey:t[a+b]};!1!==i.call(w,w.value,w)&&(null==w.value?m.push(t[a+b]):l||0===Pt(f(g),f(w.value))?(p.push(w.value),l&&y.push(t[a+b])):(m.push(t[a+b]),d.push(w.value)))}var _=Ct(n)&&n.limit===1/0&&("function"!=typeof e||e===Mt)&&{index:n.index,range:n.range};return Promise.resolve(d.length>0&&s.mutate({trans:r,type:"add",values:d}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);v(d.length,e)}))).then((function(){return(p.length>0||_&&"object"==typeof e)&&s.mutate({trans:r,type:"put",keys:y,values:p,criteria:_,changeSpec:"function"!=typeof e&&e}).then((function(e){return v(p.length,e)}))})).then((function(){return(m.length>0||_&&e===Mt)&&s.mutate({trans:r,type:"delete",keys:m,criteria:_}).then((function(e){return v(m.length,e)}))})).then((function(){return t.length>a+u&&o(a+h)}))}))};return o(0).then((function(){if(d.length>0)throw new $("Error modifying one or more objects",d,p,y);return t.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Ct(e)&&(e.isPrimKey&&!gt||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new $("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(Mt)},e}(),Mt=function(e,t){return t.value=null};function Nt(e,t){return e<t?-1:e===t?0:1}function Lt(e,t){return e>t?-1:e===t?0:1}function Ut(e,t,n){var r=e instanceof Ht?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Vt(e){return new e.Collection(e,(function(){return Gt("")})).limit(0)}function zt(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[s],c)<0&&(u=s)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function Wt(e,t,n,r){var i,o,a,u,s,c,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return Ut(e,"String expected.");function h(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Nt:Lt;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));u=t.map((function(e){return e.upper})),s=t.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var d=new e.Collection(e,(function(){return Yt(u[0],s[f-1]+r)}));d._ondirectionchange=function(e){h(e)};var p=0;return d._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,s,p))return!0;for(var d=null,y=p;y<f;++y){var v=zt(i,h,u[y],s[y],a,c);null===v&&null===d?p=y+1:(null===d||a(d,v)>0)&&(d=v)}return n(null!==d?function(){e.continue(d+l)}:r),!1})),d}function Yt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Gt(e){return{type:1,lower:e,upper:e}}var Ht=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Vt(this):new this.Collection(this,(function(){return Yt(e,t,!n,!r)}))}catch(e){return Ut(this,yt)}},e.prototype.equals=function(e){return null==e?Ut(this,yt):new this.Collection(this,(function(){return Gt(e)}))},e.prototype.above=function(e){return null==e?Ut(this,yt):new this.Collection(this,(function(){return Yt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Ut(this,yt):new this.Collection(this,(function(){return Yt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Ut(this,yt):new this.Collection(this,(function(){return Yt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Ut(this,yt):new this.Collection(this,(function(){return Yt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Ut(this,"String expected."):this.between(e,e+pt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Wt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],pt)},e.prototype.equalsIgnoreCase=function(e){return Wt(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=M.apply(F,arguments);return 0===e.length?Vt(this):Wt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=M.apply(F,arguments);return 0===e.length?Vt(this):Wt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,pt)},e.prototype.anyOf=function(){var e=this,t=M.apply(F,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Ut(this,yt)}if(0===t.length)return Vt(this);var r=new this.Collection(this,(function(){return Yt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;n(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=M.apply(F,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Ut(this,yt)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===e.length)return Vt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Ut(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ne.InvalidArgument);var s=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;var l,f=i;function h(e,t){return f(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=u(o[1],t[1]);break}}return n===i&&e.push(t),e}),[])).sort(h)}catch(e){return Ut(this,yt)}var d=0,p=c?function(e){return i(e,l[d][1])>0}:function(e){return i(e,l[d][1])>=0},y=s?function(e){return o(e,l[d][0])>0}:function(e){return o(e,l[d][0])>=0};var v=p,m=new this.Collection(this,(function(){return Yt(l[0][0],l[l.length-1][1],!s,!c)}));return m._ondirectionchange=function(e){"next"===e?(v=p,f=i):(v=y,f=o),l.sort(h)},m._addAlgorithm((function(e,t,r){for(var o=e.key;v(o);)if(++d===l.length)return t(r),!1;return!!function(e){return!p(e)&&!y(e)}(o)||(0===n._cmp(o,l[d][1])||0===n._cmp(o,l[d][0])||t((function(){f===i?e.continue(l[d][0]):e.continue(l[d][1])})),!1)})),m},e.prototype.startsWithAnyOf=function(){var e=M.apply(F,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Vt(this):this.inAnyRange(e.map((function(e){return[e,e+pt]}))):Ut(this,"startsWithAnyOf() only works with strings")},e}();function Qt(e){return Qe((function(t){return Xt(t),e(t.target.error),!1}))}function Xt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Jt=At(null,"storagemutated"),$t=function(){function e(){}return e.prototype._lock=function(){return x(!Ce.global),++this._reculock,1!==this._reculock||Ce.global||(Ce.lockOwnerFor=this),this},e.prototype._unlock=function(){if(x(!Ce.global),0==--this._reculock)for(Ce.global||(Ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{lt(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(x(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new ne.DatabaseClosed(r);case"MissingAPIError":throw new ne.MissingAPI(r.message,r);default:throw new ne.OpenFailed(r)}if(!this.active)throw new ne.TransactionInactive;return x(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Qe((function(n){Xt(n),t._reject(e.error)})),e.onabort=Qe((function(n){Xt(n),t.active&&t._reject(new ne.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Qe((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Jt.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return dt(new ne.ReadOnly("Transaction is readonly"));if(!this.active)return dt(new ne.TransactionInactive);if(this._locked())return new Be((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Ce])}));if(n)return nt((function(){var e=new Be((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Be((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Be.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Be((function(e,r){n.then((function(n){return t._waitingQueue.push(Qe(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Qe(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ne.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(h(t,e))return t[e];var n=this.schema[e];if(!n)throw new ne.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Zt(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+en(t)}}function en(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function tn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=n,i=function(e){return[e.name,e]},r.reduce((function(e,t,n){var r=i(t,n);return r&&(e[r[0]]=r[1]),e}),{}))};var r,i}var nn=function(e){try{return e.only([[]]),nn=function(){return[[]]},[[]]}catch(e){return nn=function(){return pt},pt}};function rn(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return O(t,e)}}(e):function(t){return O(t,e)}}function on(e){return[].slice.call(e)}var an=0;function un(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function sn(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}var i=function(e,t){var n=on(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=s(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:rn(t)},indexes:on(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,a={name:t,compound:s(i),keyPath:i,unique:n,multiEntry:r,extractKey:rn(i)};return o[un(i)]=a,a})),getIndexByKeyPath:function(e){return o[un(e)]}};return o[":id"]=a.primaryKey,null!=t&&(o[un(t)]=a.primaryKey),a}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),o=i.schema,a=i.hasGetAll,u=o.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(e){var n=e.trans,i=e.type,o=e.keys,a=e.values,u=e.range;return new Promise((function(e,s){e=Qe(e);var c=n.objectStore(t),l=null==c.keyPath,f="put"===i||"add"===i;if(!f&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var h,d=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],y=[],v=0,m=function(e){++v,Xt(e)};if("deleteRange"===i){if(4===u.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===u.type?p.push(h=c.clear()):p.push(h=c.delete(r(u)))}else{var b=f?l?[a,o]:[a,null]:[o,null],g=b[0],w=b[1];if(f)for(var _=0;_<d;++_)p.push(h=w&&void 0!==w[_]?c[i](g[_],w[_]):c[i](g[_])),h.onerror=m;else for(_=0;_<d;++_)p.push(h=c[i](g[_])),h.onerror=m}var x=function(t){var n=t.target.result;p.forEach((function(e,t){return null!=e.error&&(y[t]=e.error)})),e({numFailures:v,failures:y,results:"delete"===i?o:p.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){m(e),x(e)},h.onsuccess=x}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=Qe(e);for(var o,a=n.objectStore(t),u=r.length,s=new Array(u),c=0,l=0,f=function(t){var n=t.target;s[n._pos]=n.result,++l===c&&e(s)},h=Qt(i),d=0;d<u;++d){null!=r[d]&&((o=a.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++c)}0===c&&e(s)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=Qe(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Qt(i)}))},query:function(e){return function(n){return new Promise((function(i,o){i=Qe(i);var a=n.trans,u=n.values,s=n.limit,c=n.query,l=s===1/0?void 0:s,f=c.index,h=c.range,d=a.objectStore(t),p=f.isPrimaryKey?d:d.index(f.name),y=r(h);if(0===s)return i({result:[]});if(e){var v=u?p.getAll(y,l):p.getAllKeys(y,l);v.onsuccess=function(e){return i({result:e.target.result})},v.onerror=Qt(o)}else{var m=0,b=u||!("openKeyCursor"in p)?p.openCursor(y):p.openKeyCursor(y),g=[];b.onsuccess=function(e){var t=b.result;return t?(g.push(u?t.value:t.primaryKey),++m===s?i({result:g}):void t.continue()):i({result:g})},b.onerror=Qt(o)}}))}}(a),openCursor:function(e){var n=e.trans,i=e.values,o=e.query,a=e.reverse,u=e.unique;return new Promise((function(e,s){e=Qe(e);var c=o.index,l=o.range,f=n.objectStore(t),h=c.isPrimaryKey?f:f.index(c.name),d=a?u?"prevunique":"prev":u?"nextunique":"next",p=i||!("openKeyCursor"in h)?h.openCursor(r(l),d):h.openKeyCursor(r(l),d);p.onerror=Qt(s),p.onsuccess=Qe((function(t){var r=p.result;if(r){r.___id=++an,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Qe(s),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Qe(e),p.onerror=Qt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=u,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Qe((function(e){p.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,n(),t},e(r)}else e(null)}),s)}))},count:function(e){var n=e.query,i=e.trans,o=n.index,a=n.range;return new Promise((function(e,n){var u=i.objectStore(t),s=o.isPrimaryKey?u:u.index(o.name),c=r(a),l=c?s.count(c):s.count();l.onsuccess=Qe((function(t){return e(t.target.result)})),l.onerror=Qt(n)}))}}}(e)})),c={};return u.forEach((function(e){return c[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!c[e])throw new Error("Table '".concat(e,"' not found"));return c[e]},MIN_KEY:-1/0,MAX_KEY:nn(t),schema:o}}function cn(e,t,n,r){var o=n.IDBKeyRange;return n.indexedDB,{dbcore:function(e,t){return t.reduce((function(e,t){var n=t.create;return i(i({},e),n(e))}),e)}(sn(t,o,r),e.dbcore)}}function ln(e,t){var n=t.db,r=cn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function fn(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){var r=b(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?y(t,n,{get:function(){return this.table(n)},set:function(e){p(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function hn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function dn(e,t){return e._cfg.version-t._cfg.version}function pn(e,t,n,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),s=Ce.transless||Ce;nt((function(){Ce.trans=o,Ce.transless=s,0===t?(u(i).forEach((function(e){vn(n,e,i[e].primKey,i[e].indexes)})),ln(e,n),Be.follow((function(){return e.on.populate.fire(o)})).catch(a)):function(e,t,n,r){var i=[],o=e._versions,a=e._dbSchema=bn(e,e.idbdb,r),s=!1;function c(){return i.length?Be.resolve(i.shift()(n.idbtrans)).then(c):Be.resolve()}return o.filter((function(e){return e._cfg.version>=t})).forEach((function(o){i.push((function(){var i=a,c=o._cfg.dbschema;gn(e,i,r),gn(e,c,r),a=e._dbSchema=c;var l=yn(i,c);l.add.forEach((function(e){vn(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new ne.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return mn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),mn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var f=o._cfg.contentUpgrade;if(f&&o._cfg.version>t){ln(e,r),n._memoizedTables={},s=!0;var h=E(c);l.del.forEach((function(e){h[e]=i[e]})),hn(e,[e.Transaction.prototype]),fn(e,[e.Transaction.prototype],u(h),h),n.schema=h;var d,p=N(f);p&&rt();var y=Be.follow((function(){if((d=f(n))&&p){var e=it.bind(null,null);d.then(e,e)}}));return d&&"function"==typeof d.then?Be.resolve(d):y.then((function(){return d}))}})),i.push((function(t){s&&bt||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))}(o._cfg.dbschema,t);hn(e,[e.Transaction.prototype]),fn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),c().then((function(){var e,t;t=r,u(e=a).forEach((function(n){t.db.objectStoreNames.contains(n)||vn(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,o,n).catch(a)}))}function yn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!mt)a.recreate=!0,r.change.push(a);else{var u=i.idxByName,s=o.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,o])}return r}function vn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return mn(i,e)})),i}function mn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function bn(e,t,n){var r={};return w(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=Zt(en(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<t.indexNames.length;++u){var s=t.index(t.indexNames[u]);i=s.keyPath;var c=Zt(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=tn(e,o,a)})),r}function gn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],u=n.objectStore(o);e._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],l=u.index(c).keyPath,f="string"==typeof l?l:"["+w(l).join("+")+"]";if(t[o]){var h=t[o].idxByName[f];h&&(h.name=c,delete t[o].idxByName[f],t[o].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}var wn,_n=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){u(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Zt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(r),0===t)})),i=r.shift();if(i.multi)throw new ne.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ne.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ne.Schema("Index must have a name and cannot be an empty string")})),t[n]=tn(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){c(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,hn(t,[t._allTables,t,t.Transaction.prototype]),fn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],u(i),i),t._storeNames=u(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=de(this._cfg.contentUpgrade||oe,e),this},e}();function xn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new fr("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function kn(e){return e&&"function"==typeof e.databases}function On(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!kn(n)&&"__dbnames"!==t&&xn(n,r).delete(t).catch(oe)}function Pn(e){return nt((function(){return Ce.letThrough=!0,e()}))}function En(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Kn(e){return!("from"in e)}var Sn=function(e,t){if(!this){var n=new Sn;return e&&"d"in e&&c(n,e),n}c(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function An(e,t,n){var r=Pt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Kn(e))return c(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(Pt(n,e.from)<0)return i?An(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Dn(e);if(Pt(t,e.to)>0)return o?An(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Dn(e);Pt(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Pt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&jn(e,i),o&&a&&jn(e,o)}}function jn(e,t){Kn(t)||function e(t,n){var r=n.from,i=n.to,o=n.l,a=n.r;An(t,r,i),o&&e(t,o),a&&e(t,a)}(e,t)}function Cn(e,t){var n=qn(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=qn(e),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(Pt(u.from,i.to)<=0&&Pt(u.to,i.from)>=0)return!0;Pt(i.from,u.from)<0?i=(r=n.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function qn(e){var t=Kn(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Pt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Pt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Dn(e){var t,n,r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){var a="r"===o?"l":"r",u=i({},e),s=e[o];e.from=s.from,e.to=s.to,e[o]=s[o],u[o]=s[a],e[a]=u,u.d=In(u)}e.d=In(e)}function In(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Bn(e,t){return u(t).forEach((function(n){e[n]?jn(e[n],t[n]):e[n]=function e(t){var n={};for(var r in t)if(h(t,r)){var i=t[r];n[r]=!i||"object"!=typeof i||j.has(i.constructor)?i:e(i)}return n}(t[n])})),e}function Tn(e,t){return Object.keys(e).some((function(n){return t[n]&&Cn(t[n],e[n])}))}d(Sn.prototype,((wn={add:function(e){return jn(this,e),this},addKey:function(e){return An(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return An(t,e,e)})),this}})[B]=function(){return qn(this)},wn));var Rn={},Fn={},Mn=!1;function Nn(e){Bn(Fn,e),Mn||(Mn=!0,queueMicrotask((function(){Mn=!1;var e=Fn;Fn={},Ln(e)})))}function Ln(e,t){void 0===t&&(t=!1);var n=new Set;for(var r in e){var i=/^idb\:\/\/(.*)\/(.*)\//.exec(r);if(i){var o=i[1],a=i[2],u=Rn["idb://".concat(o,"/").concat(a)];u&&Un(u,e,n,t)}}n.forEach((function(e){return e()}))}function Un(e,t,n,r){for(var i=r&&[],o=0,a=Object.entries(e.queries.query);o<a.length;o++){for(var u=a[o],s=u[0],c=r&&[],l=0,f=u[1];l<f.length;l++){var h=f[l];h.obsSet&&Tn(t,h.obsSet)?h.subscribers.forEach((function(e){return n.add(e)})):r&&c.push(h)}r&&i.push([s,c])}if(r)for(var d=0,p=i;d<p.length;d++){var y=p[d];s=y[0],c=y[1];e.queries.query[s]=c}}function Vn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?dt(t.dbOpenError):e}));L&&(t.openCanceller._stackHolder=W()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new ne.DatabaseClosed("db.open() was cancelled")}var o=t.dbReadyResolve,a=null,s=!1;return Be.race([r,("undefined"==typeof navigator?Be.resolve():En()).then((function(){return new Be((function(r,o){if(i(),!n)throw new ne.MissingAPI;var c=e.name,l=t.autoSchema?n.open(c):n.open(c,Math.round(10*e.verno));if(!l)throw new ne.MissingAPI;l.onerror=Qt(o),l.onblocked=Qe(e._fireOnBlocked),l.onupgradeneeded=Qe((function(r){if(a=l.transaction,t.autoSchema&&!e._options.allowEmptyDB){l.onerror=Xt,a.abort(),l.result.close();var i=n.deleteDatabase(c);i.onsuccess=i.onerror=Qe((function(){o(new ne.NoSuchDatabase("Database ".concat(c," doesnt exist")))}))}else{a.onerror=Qt(o);var u=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;s=u<1,e.idbdb=l.result,pn(e,u/10,a,o)}}),o),l.onsuccess=Qe((function(){a=null;var n,i=e.idbdb=l.result,o=w(i.objectStoreNames);if(o.length>0)try{var f=i.transaction(1===(n=o).length?n[0]:n,"readonly");t.autoSchema?function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=bn(0,t,n);e._storeNames=w(t.objectStoreNames,0),fn(e,[e._allTables],u(r),r)}(e,i,f):(gn(e,e._dbSchema,f),function(e,t){var n=yn(bn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ln(e,f)}catch(e){}vt.push(e),i.onversionchange=Qe((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),i.onclose=Qe((function(t){e.on("close").fire(t)})),s&&function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!kn(n)&&"__dbnames"!==t&&xn(n,r).put({name:t}).catch(oe)}(e._deps,c),r()}),o)}))}))]).then((function(){return i(),t.onReadyBeingFired=[],Be.resolve(Pn((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(de,oe);return t.onReadyBeingFired=[],Be.resolve(Pn((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{a&&a.abort()}catch(e){}return r===t.openCanceller&&e._close(),dt(n)})).finally((function(){t.openComplete=!0,o()})).then((function(){if(s){var t={};e.tables.forEach((function(n){n.schema.indexes.forEach((function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new Sn(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new Sn(-1/0,[[[]]])})),Jt("storagemutated").fire(t),Ln(t,!0)}return e}))}function zn(e){var t=function(t){return e.next(t)},n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):s(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function Wn(e,t,n){var r=arguments.length;if(r<2)throw new ne.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=S(i);return[e,o,n]}function Yn(e,t,n,r,i){return Be.resolve().then((function(){var o=Ce.transless||Ce,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;var u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===ee.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((function(){return Yn(e,t,n,null,i)}))):dt(r)}var s,c=N(i);c&&rt();var l=Be.follow((function(){if(s=i.call(a,a))if(c){var e=it.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=zn(s))}),u);return(s&&"function"==typeof s.then?Be.resolve(s).then((function(e){return a.active?e:dt(new ne.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),dt(e)}))}))}function Gn(e,t,n){for(var r=s(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var Hn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return i(i({},e),{table:function(t){var n=e.table(t),r=n.schema,o={},a=[];function u(e,t,n){var r=un(e),s=o[r]=o[r]||[],c=null==e?0:"string"==typeof e?1:e.length,l=t>0,f=i(i({},n),{name:l?"".concat(r,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:l,keyTail:t,keyLength:c,extractKey:rn(e),unique:!l&&n.unique});(s.push(f),f.isPrimaryKey||a.push(f),c>1)&&u(2===c?e[0]:e.slice(0,c-1),t+1,n);return s.sort((function(e,t){return e.keyTail-t.keyTail})),f}var s=u(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[s];for(var c=0,l=r.indexes;c<l.length;c++){var f=l[c];u(f.keyPath,0,f)}function h(t){var n,r,o=t.query.index;return o.isVirtual?i(i({},t),{query:{index:o.lowLevelIndex,range:(n=t.query.range,r=o.keyTail,{type:1===n.type?2:n.type,lower:Gn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,r),lowerOpen:!0,upper:Gn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,r),upperOpen:!0})}}):t}return i(i({},n),{schema:i(i({},r),{primaryKey:s,indexes:a,getIndexByKeyPath:function(e){var t=o[un(e)];return t&&t[0]}}),count:function(e){return n.count(h(e))},query:function(e){return n.query(h(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return n.openCursor(t);return n.openCursor(h(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(Gn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Gn(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}(n)}))}})}})}};function Qn(e,t,n,r){return n=n||{},r=r||"",u(e).forEach((function(i){if(h(t,i)){var o=e[i],a=t[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var u=I(o);u!==I(a)?n[r+i]=t[i]:"Object"===u?Qn(o,a,n,r+i+"."):o!==a&&(n[r+i]=t[i])}else o!==a&&(n[r+i]=t[i])}else n[r+i]=void 0})),u(t).forEach((function(i){h(e,i)||(n[r+i]=t[i])})),n}function Xn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Jn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return i(i({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return i(i({},n),{mutate:function(e){var a=Ce.trans,u=a.table(t).hook,s=u.deleting,c=u.creating,l=u.updating;switch(e.type){case"add":if(c.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"put":if(c.fire===oe&&l.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"delete":if(s.fire===oe)break;return a._promise("readwrite",(function(){return f(e)}),!0);case"deleteRange":if(s.fire===oe)break;return a._promise("readwrite",(function(){return function(e){return function e(t,o,a){return n.query({trans:t,values:!1,query:{index:r,range:o},limit:a}).then((function(n){var r=n.result;return f({type:"delete",keys:r,trans:t}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):r.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(t,i(i({},o),{lower:r[r.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function f(e){var t=Ce.trans,a=e.keys||Xn(r,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?i(i({},e),{keys:a}):i({},e)).type&&(e.values=o([],e.values,!0)),e.keys&&(e.keys=o([],e.keys,!0)),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,a).then((function(i){var o=a.map((function(n,o){var a=i[o],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,n,a,t);else if("add"===e.type||void 0===a){var f=c.fire.call(u,n,e.values[o],t);null==n&&null!=f&&(n=f,e.keys[o]=n,r.outbound||P(e.values[o],r.keyPath,n))}else{var d=Qn(a,e.values[o]),p=l.fire.call(u,d,n,a,t);if(p){var y=e.values[o];Object.keys(p).forEach((function(e){h(y,e)?y[e]=p[e]:P(y,e,p[e])}))}}return u}));return n.mutate(e).then((function(t){for(var n=t.failures,r=t.results,u=t.numFailures,s=t.lastResult,c=0;c<a.length;++c){var l=r?r[c]:a[c],f=o[c];null==l?f.onerror&&f.onerror(n[c]):f.onsuccess&&f.onsuccess("put"===e.type&&i[c]?e.values[c]:l)}return{failures:n,results:r,numFailures:u,lastResult:s}})).catch((function(e){return o.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function $n(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Pt(t.keys[i],e[o])&&(r.push(n?q(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Zn={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return i(i({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=$n(e.keys,e.trans._cache,"clone"===e.cache);return t?Be.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?q(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function er(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function tr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var nr={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Sn(e.MIN_KEY,e.MAX_KEY);return i(i({},e),{transaction:function(t,n,r){if(Ce.subscr&&"readonly"!==n)throw new ne.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ce.querier));return e.transaction(t,n,r)},table:function(r){var o=e.table(r),a=o.schema,c=a.primaryKey,l=c.extractKey,f=c.outbound,h=i(i({},o),{mutate:function(e){var i=e.trans,u=e.mutatedParts||(e.mutatedParts={}),l=function(e){var n="idb://".concat(t,"/").concat(r,"/").concat(e);return u[n]||(u[n]=new Sn)},f=l(""),h=l(":dels"),d=e.type,p="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Xn(c,e).filter((function(e){return e})),e.values]:[],y=p[0],v=p[1],m=e.trans._cache;if(s(y)){f.addKeys(y);var b="delete"===d||y.length===v.length?$n(y,m):null;b||"add"===d||h.addKeys(y),(b||v)&&function(e,t,n,r){t.indexes.forEach((function(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var a=function(e){return t.multiEntry&&s(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(n||r).forEach((function(e,t){var i=n&&o(n[t]),u=r&&o(r[t]);0!==Pt(i,u)&&(null!=i&&a(i),null!=u&&a(u))}))}))}(l,a,b,v)}else if(y){var g={from:y.lower,to:y.upper};h.add(g),f.add(g)}else f.add(n),h.add(n),a.indexes.forEach((function(e){return l(e.name).add(n)}));return o.mutate(e).then((function(t){return!y||"add"!==e.type&&"put"!==e.type||f.addKeys(t.results),i.mutatedParts=Bn(i.mutatedParts||{},u),t}))}}),d=function(t){var n,r,i=t.query,o=i.index,a=i.range;return[o,new Sn(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},p={get:function(e){return[c,new Sn(e.key)]},getMany:function(e){return[c,(new Sn).addKeys(e.keys)]},count:d,query:d,openCursor:d};return u(p).forEach((function(e){h[e]=function(a){var u=Ce.subscr,s=!!u,c=er(Ce,o)&&tr(e,a),h=c?a.obsSet={}:u;if(s){var d=function(e){var n="idb://".concat(t,"/").concat(r,"/").concat(e);return h[n]||(h[n]=new Sn)},y=d(""),v=d(":dels"),m=p[e](a),b=m[0],g=m[1];if(d(b.name||"").add(g),!b.isPrimaryKey){if("count"!==e){var w="query"===e&&f&&a.values&&o.query(i(i({},a),{values:!1}));return o[e].apply(this,arguments).then((function(t){if("query"===e){if(f&&a.values)return w.then((function(e){var n=e.result;return y.addKeys(n),t}));var n=a.values?t.result.map(l):t.result;a.values?y.addKeys(n):v.addKeys(n)}else if("openCursor"===e){var r=t,i=a.values;return r&&Object.create(r,{key:{get:function(){return v.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return v.addKey(e),e}},value:{get:function(){return i&&y.addKey(r.primaryKey),r.value}}})}return t}))}v.add(n)}}return o[e].apply(this,arguments)}})),h}})}};function rr(e,t){return function(e,t){return void 0===t.lower||(t.lowerOpen?Pt(e,t.lower)>0:Pt(e,t.lower)>=0)}(e,t)&&function(e,t){return void 0===t.upper||(t.upperOpen?Pt(e,t.upper)<0:Pt(e,t.upper)<=0)}(e,t)}function ir(e,t,n,r,i,o){if(!n||0===n.length)return e;var a=t.query.index,u=r.schema.primaryKey.extractKey,s=a.extractKey,c=(a.lowLevelIndex||a).extractKey,l=n.reduce((function(e,n){var r=e,i="add"===n.type||"put"===n.type?n.values.filter((function(e){return rr(s(e),t.query.range)})).map((function(e){return e=q(e),o&&Object.freeze(e),e})):[];switch(n.type){case"add":r=e.concat(t.values?i:i.map((function(e){return u(e)})));break;case"put":var a=(new Sn).addKeys(n.values.map((function(e){return u(e)})));r=e.filter((function(e){var n=t.values?u(e):e;return!Cn(new Sn(n),a)})).concat(t.values?i:i.map((function(e){return u(e)})));break;case"delete":var c=(new Sn).addKeys(n.keys);r=e.filter((function(e){var n=t.values?u(e):e;return!Cn(new Sn(n),c)}));break;case"deleteRange":var l=n.range;r=e.filter((function(e){return!rr(u(e),l)}))}return r}),e);return l===e?e:(l.sort((function(e,t){return Pt(c(e),c(t))||Pt(u(e),u(t))})),t.limit&&t.limit<1/0&&(l.length>t.limit?l.length=t.limit:e.length===t.limit&&l.length<t.limit&&(i.dirty=!0)),o?Object.freeze(l):l)}function or(e,t){return 0===Pt(e.lower,t.lower)&&0===Pt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function ar(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var i=Pt(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var i=Pt(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function ur(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",(function(){e.subscribers.delete(n),0===e.subscribers.size&&function(e,t){setTimeout((function(){0===e.subscribers.size&&R(t,e)}),3e3)}(e,t)}))}var sr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return i(i({},e),{transaction:function(n,r,i){var o=e.transaction(n,r,i);if("readwrite"===r){var a=new AbortController,u=a.signal,s=function(i){return function(){if(a.abort(),"readwrite"===r){for(var u=new Set,s=0,c=n;s<c.length;s++){var l=c[s],f=Rn["idb://".concat(t,"/").concat(l)],h=e.table(l);if(f){var d=f.optimisticOps.filter((function(e){return e.trans===o}));if(d.length>0){f.optimisticOps=f.optimisticOps.filter((function(e){return e.trans!==o}));for(var p=0,y=Object.values(f.queries.query);p<y.length;p++)for(var v=y[p],m=0,b=v.slice();m<b.length;m++){var g=b[m];if(null!=g.res&&o.mutatedParts)if(i&&!g.dirty){var w=Object.isFrozen(g.res),_=ir(g.res,g.req,d,h,g,w);g.dirty?(R(v,g),g.subscribers.forEach((function(e){return u.add(e)}))):_!==g.res&&(g.res=_,g.promise=Be.resolve({result:_}))}else g.dirty&&R(v,g),g.subscribers.forEach((function(e){return u.add(e)}))}}}}u.forEach((function(e){return e()}))}}};o.addEventListener("abort",s(!1),{signal:u}),o.addEventListener("error",s(!1),{signal:u}),o.addEventListener("complete",s(!0),{signal:u})}return o},table:function(n){var r=e.table(n),o=r.schema.primaryKey;return i(i({},r),{mutate:function(e){if(o.outbound||"disabled"===Ce.trans.db._options.cache)return r.mutate(e);var a=Rn["idb://".concat(t,"/").concat(n)];if(!a)return r.mutate(e);var u=r.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Xn(o,e).some((function(e){return null==e})))?(a.optimisticOps.push(e),Nn(e.mutatedParts),u.catch((function(){R(a.optimisticOps,e),Nn(e.mutatedParts)}))):u.then((function(t){var n=i(i({},e),{values:e.values.map((function(e,n){var r=o.keyPath.includes(".")?q(e):i({},e);return P(r,o.keyPath,t.results[n]),r}))});a.optimisticOps.push(n),queueMicrotask((function(){return Nn(e.mutatedParts)}))})),u},query:function(e){if(!er(Ce,r)||!tr("query",e))return r.query(e);var i="immutable"===Ce.trans.db._options.cache,o=Ce,a=o.requery,u=o.signal,s=function(e,t,n,r){var i=Rn["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[n];if(!o)return[null,!1,i,null];var a=o[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,i,null];switch(n){case"query":var u=a.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&or(e.req.query.range,r.query.range)}));return u?[u,!0,i,a]:[a.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&ar(e.req.query.range,r.query.range)})),!1,i,a];case"count":var s=a.find((function(e){return or(e.req.query.range,r.query.range)}));return[s,!!s,i,a]}}(t,n,"query",e),c=s[0],l=s[1],f=s[2],h=s[3];if(c&&l)c.obsSet=e.obsSet;else{var d=r.query(e).then((function(e){var t=e.result;if(c.res=t,i){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=q(t);return e})).catch((function(e){return h&&c&&R(h,c),Promise.reject(e)}));c={obsSet:e.obsSet,promise:d,subscribers:new Set,type:"query",req:e,dirty:!1},h?h.push(c):(h=[c],f||(f=Rn["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),f.queries.query[e.query.index.name||""]=h)}return ur(c,h,a,u),c.promise.then((function(t){return{result:ir(t.result,e,null==f?void 0:f.optimisticOps,r,c,i)}}))}})}})}};function cr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var lr,fr=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=i({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u,s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:oe,dbReadyPromise:null,cancelOpen:oe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new Be((function(e){s.dbReadyResolve=e})),s.openCanceller=new Be((function(e,t){s.cancelOpen=t})),this._state=s,this.name=t,this.on=At(this,"populate","blocked","versionchange","close",{ready:[de,oe]}),this.on.ready.subscribe=_(this.on.ready.subscribe,(function(t){return function(n,i){e.vip((function(){var e=r._state;if(e.openComplete)e.dbOpenError||Be.resolve().then(n),i&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),i&&t(n);else{t(n);var o=r;i||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(u=this,jt(Ft.prototype,(function(e,t){this.db=u;var n=xt,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,a=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:a!==ae?a:null}}))),this.Table=function(e){return jt(St.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:At(null,{creating:[ce,oe],reading:[ue,ae],updating:[fe,oe],deleting:[le,oe]})}))}(this),this.Transaction=function(e){return jt($t.prototype,(function(t,n,r,i,o){var a=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=At(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Be((function(e,t){a._resolve=e,a._reject=t})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),dt(e)}))}))}(this),this.Version=function(e){return jt(_n.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return jt(Ht.prototype,(function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=Pt,this._descending=function(e,t){return Pt(t,e)},this._max=function(e,t){return Pt(e,t)>0?e:t},this._min=function(e,t){return Pt(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new ne.MissingAPI}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1}),r._state.openComplete=!1})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=nn(n.IDBKeyRange),this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){r.on("blocked").fire(e),vt.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Zn),this.use(sr),this.use(nr),this.use(Hn),this.use(Jn);var c=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return cr(r.table(e),c)};var i=Reflect.get(e,t,n);return i instanceof St?cr(i,c):"tables"===t?i.map((function(e){return cr(e,c)})):"_createTransaction"===t?function(){var e=i.apply(this,arguments);return cr(e,c)}:i}});this.vip=c,a.forEach((function(e){return e(r)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ne.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ne.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(dn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Ce.letThrough||this._vip)?e():new Be((function(e,n){if(t._state.openComplete)return n(new ne.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new ne.DatabaseClosed);t.open().catch(oe)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){var e=this;return lt(je,(function(){return Vn(e)}))},e.prototype._close=function(){var e=this._state,t=vt.indexOf(this);if(t>=0&&vt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.dbReadyPromise=new Be((function(t){e.dbReadyResolve=t})),e.openCanceller=new Be((function(t,n){e.cancelOpen=n}))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;this._close();var n=this._state;t&&(this._options.autoOpen=!1),n.dbOpenError=new ne.DatabaseClosed,n.isBeingOpened&&n.cancelOpen(n.dbOpenError)},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new Be((function(r,i){var o=function(){e.close({disableAutoOpen:!1});var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Qe((function(){On(e._deps,e.name),r()})),t.onerror=Qt(i),t.onblocked=e._fireOnBlocked};if(t)throw new ne.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return u(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Wn.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=Ce.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new ne.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!u)throw new ne.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!u)throw new ne.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):dt(e)}var s=Yn.bind(null,this,o,a,i,n);return i?i._promise(o,s,"lock"):Ce.trans?lt(Ce.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!h(this._allTables,e))throw new ne.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),hr="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",dr=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[hr]=function(){return this},e}();try{lr={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch(e){lr={indexedDB:null,IDBKeyRange:null}}var pr=fr;function yr(e){var t=vr;try{vr=!0,Jt.storagemutated.fire(e),Ln(e,!0)}finally{vr=t}}d(pr,i(i({},ie),{delete:function(e){return new pr(e,{addons:[]}).delete()},exists:function(e){return new pr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return function(e){var t=e.indexedDB,n=e.IDBKeyRange;return kn(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):xn(t,n).toCollection().primaryKeys()}(pr.dependencies).then(e)}catch(e){return dt(new ne.MissingAPI)}},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return Ce.trans?lt(Ce.transless,e):e()},vip:Pn,async:function(e){return function(){try{var t=zn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Be.resolve(t)}catch(e){return dt(e)}}},spawn:function(e,t,n){try{var r=zn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Be.resolve(r)}catch(e){return dt(e)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(e,t){var n=Be.resolve("function"==typeof e?pr.ignoreTransaction(e):e).timeout(t||6e4);return Ce.trans?Ce.trans.waitFor(n):n},Promise:Be,debug:{get:function(){return L},set:function(e){U(e,"dexie"===e?function(){return!0}:wt)}},derive:v,extend:c,props:d,override:_,Events:At,on:Jt,liveQuery:function(e){var t,n=!1,r=new dr((function(r){var i=N(e);var o,a=!1,u={},s={},c={get closed(){return a},unsubscribe:function(){a||(a=!0,o&&o.abort(),l&&Jt.storagemutated.unsubscribe(f))}};r.start&&r.start(c);var l=!1;var f=function(e){Bn(u,e),Tn(s,u)&&d()},d=function(){if(!a&&lr.indexedDB){u={};var c={};o&&o.abort(),o=new AbortController;var p={subscr:c,signal:o.signal,requery:d,querier:e,trans:null},y=function(t){var n=We();try{i&&rt();var r=nt(e,t);return i&&r.finally(it),r}finally{n&&Ye()}}(p);Promise.resolve(y).then((function(e){n=!0,t=e,a||p.signal.aborted||(u={},function(e){for(var t in e)if(h(e,t))return!1;return!0}(s=c)||l||(Jt("storagemutated",f),l=!0),r.next&&r.next(e))}),(function(e){if(n=!1,!["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)){if(a)return;r.error&&r.error(e)}}))}};return d(),c}));return r.hasValue=function(){return n},r.getValue=function(){return t},r},extendObservabilitySet:Bn,getByKeyPath:O,setByKeyPath:P,delByKeyPath:function(e,t){"string"==typeof t?P(e,t,void 0):"length"in t&&[].map.call(t,(function(t){P(e,t,void 0)}))},shallowClone:E,deepClone:q,getObjectDiff:Qn,cmp:Pt,asap:k,minKey:-1/0,addons:[],connections:vt,errnames:ee,dependencies:lr,cache:Rn,semVer:"4.0.1-alpha.25",version:"4.0.1-alpha.25".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),pr.maxKey=nn(pr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Jt("storagemutated",(function(e){var t;vr||(mt?(t=document.createEvent("CustomEvent")).initCustomEvent("x-storagemutated-1",!0,!0,e):t=new CustomEvent("x-storagemutated-1",{detail:e}),vr=!0,dispatchEvent(t),vr=!1)})),addEventListener("x-storagemutated-1",(function(e){var t=e.detail;vr||yr(t)})));var vr=!1;if("undefined"!=typeof BroadcastChannel){var mr=new BroadcastChannel("x-storagemutated-1");"function"==typeof mr.unref&&mr.unref(),Jt("storagemutated",(function(e){vr||mr.postMessage(e)})),mr.onmessage=function(e){e.data&&yr(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){Jt("storagemutated",(function(e){try{vr||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&o([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach((function(t){return t.postMessage({type:"x-storagemutated-1",changedParts:e})})))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(function(e){if("x-storagemutated-1"===e.key){var t=JSON.parse(e.newValue);t&&yr(t.changedParts)}}));var br=self.document&&navigator.serviceWorker;br&&br.addEventListener("message",(function(e){var t=e.data;t&&"x-storagemutated-1"===t.type&&yr(t.changedParts)}))}Be.rejectionMapper=function(e,t){if(!e||e instanceof X||e instanceof TypeError||e instanceof SyntaxError||!e.name||!re[e.name])return e;var n=new re[e.name](t||e.message,e);return"stack"in e&&y(n,"stack",{get:function(){return this.inner.stack}}),n},U(L,wt)}}]);